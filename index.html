<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>宏恩生產批號紀錄</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%); min-height: 100vh; box-sizing: border-box; }
        .glass-container { background: rgba(255, 255, 255, 0.25); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.18); border-radius: 16px; padding: 20px; }
        .container { max-width: 800px; margin: auto; }
        #authSection { margin-bottom: 20px; padding: 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.3); text-align: center; }
        #welcomeMessage { display: flex; justify-content: space-between; align-items: center; font-size: 1.1em; color: #333; }
        #welcomeMessage button { background-color: #dc3545; width: auto; padding: 8px 15px; font-size: 14px; }
        #welcomeMessage button:hover { background-color: #c82333; }
        #homeView h2, #loginView h2 { border-bottom: 1px solid rgba(255, 255, 255, 0.3); padding-bottom: 10px; color: #333; }
        label { color: #333; font-weight: 500; }
        .material-list { list-style: none; padding: 0; display: flex; flex-wrap: wrap; gap: 10px; }
        .material-list li { flex-grow: 1; flex-basis: 150px; min-width: 120px; }
        .material-list a { display: block; padding: 10px 12px; background: rgba(255, 255, 255, 0.4); border-radius: 8px; text-decoration: none; color: #333; font-weight: 600; text-align: center; border: 1px solid rgba(255, 255, 255, 0.2); box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); transition: background 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease; }
        .material-list a:hover { background: rgba(255, 255, 255, 0.7); transform: translateY(-3px); box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1); }
        #detailView { display: none; }
        .back-link { display: inline-block; margin-bottom: 15px; text-decoration: none; color: #0056b3; font-weight: bold; }
        form { margin-bottom: 20px; padding: 0; border: none; }
        input, select { margin-bottom: 10px; width: 100%; padding: 12px; box-sizing: border-box; background: rgba(255, 255, 255, 0.5); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 8px; color: #333; font-size: 16px; }
        input::placeholder { color: #555; }
        button { background-color: #007bff; color: white; border: none; cursor: pointer; padding: 12px; font-size: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); transition: background 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease; }
        button:hover { background-color: #0056b3; transform: translateY(-3px); box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2); }
        #searchForm button[type="submit"] { background-color: #28a745; }
        #searchForm button[type="submit"]:hover { background-color: #218838; }
        button:disabled { background-color: #aaa; box-shadow: none; }
        button:disabled:hover { transform: none; box-shadow: none; background-color: #aaa; }
        #searchResults { margin-top: -10px; margin-bottom: 20px; padding: 15px; background: rgba(255, 255, 255, 0.2); border-radius: 8px; display: none; border: 1px solid rgba(255, 255, 255, 0.1); }
        table { width: 100%; border-collapse: collapse; background: rgba(255, 255, 255, 0.2); border-radius: 8px; overflow: hidden; }
        th, td { border: 1px solid rgba(255, 255, 255, 0.3); padding: 12px; text-align: left; }
        th { background-color: rgba(255, 255, 255, 0.3); color: #333; }
        .is-hidden { display: none !important; } /* (新) 輔助 class */
        /* (新) 刪除按鈕樣式 */
        .delete-btn { background-color: #dc3545; font-size: 12px; padding: 5px 8px; width: auto; margin-left: 10px; }
        .delete-btn:hover { background-color: #c82333; }
        
        /* --- (新) 頂部外部連結樣式 --- */
        .external-link-container {
            text-align: right;
            margin-bottom: 5px; /* 與下方登入區塊的間距 */
        }
        .external-link-container a {
            text-decoration: none;
            color: #0056b3;
            font-weight: 600;
            font-size: 14px;
            padding: 5px 10px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
        }
        .external-link-container a:hover {
            background: rgba(255, 255, 255, 0.5);
            color: #000;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>

    <div class="container glass-container">

        <div class="external-link-container">
            <a href="http://a3996123.drayddns.com:18888/products.html" target="_blank">宏恩產品查詢 &rarr;</a>
        </div>

        <div id="authSection">
            <button id="loginButton">使用 Google 登入</button>
            
            <div id="welcomeMessage" class="is-hidden">
                <span>歡迎, <strong id="userName"></strong>!</span>
                <button id="logoutButton">登出</button>
            </div>
        </div>
        
        <div id="homeView">
            <h2 style="color: #28a745; border-bottom-color: #28a745;">搜尋桶別</h2>
            <form id="searchForm" style="border-color: #ccc;">
                <label for="searchMaterialSelect">1. 選擇料號:</label>
                <select id="searchMaterialSelect" required><option value="">請先登入...</option></select>
                <label for="searchBarrelInput" style="margin-top: 10px; display: block;">2. 輸入桶別 (可選):</label>
                <input type="text" id="searchBarrelInput" placeholder="輸入桶別 (可選，留空則查詢全部)">
                <button type="submit" style="background-color: #28a745;">搜尋</button>
            </form>
            <div id="searchResults"></div>

            <form id="newMaterialForm" class="is-hidden">
                <h2 style="border-top: 2px solid #eee; padding-top: 20px;">新增料號</h2>
                <label for="newMaterialInput">新料號:</label>
                <input type="text" id="newMaterialInput" placeholder="例如: B5001-01" required>
                <button type="submit">儲存新料號</button>
            </form>

            <h2 style="border-top: 2px solid #eee; padding-top: 20px;">選擇料號</h2>
            <ul id="materialList" class="material-list"><li>請先登入...</li></ul>
        </div>

        <div id="detailView">
            <a href="#" class="back-link">← 返回首頁</a>
            <h2 id="detailTitle"></h2>
            
            <form id="recordForm" class="is-hidden">
                <h3>新增桶別</h3>
                <label for="barrelNumber">輸入新桶別:</label>
                <input type="text" id="barrelNumber" placeholder="例如: 005, 006..." required>
                <button type="submit">儲存紀錄</button>
            </form>

            <h3>目前已紀錄桶別</h3>
            <table id="recordTable">
                <thead><tr><th>紀錄時間 (台北)</th><th>操作員</th><th>桶別</th><th>操作</th></tr></thead>
                <tbody id="recordBody"></tbody>
            </table>
        </div>

    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script> <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-check-compat.js"></script>
    
    <script src="script.js"></script>
</body>
</html>
